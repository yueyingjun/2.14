<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<style>
		.outer{
			width:200px;
			height:200px;
			position:relative;
			background:red;
			margin:200px;			
		}
		.inner{
			width:100px;
			height:100px;
			background:blue;
			position:absolute;
			left:0;
			top:0;
		}
	</style>
	<script>
		//拖拽
//		1. 定位  通过定位   或者  margin
//		2. 分析 拖拽的动作
//		3. 分解动作
		//面向对象
		document.addEventListener("DOMContentLoaded",function(){
			
//			var div=document.querySelector(".inner");
//			console.log(div)
//			div.onmousedown=function(e){
//				var e=e||window.event;
//				var ox=e.clientX;
//				var oy=e.clientY;
//				var left=div.offsetLeft;
//				var top=div.offsetTop;				
//				var lenx=ox-left;
//				var leny=oy-top;
//				document.onmousemove=function(e){
//					var e=e||window.event;
//					var cx=e.clientX;
//					var cy=e.clientY;
//					var x=cx-lenx;
//					var y=cy-leny;
//					div.style.left=x+'px'
//					div.style.top=y+'px'					
//				}
//				document.onmouseup=function(){
//					document.onmousemove=null;
//					document.onmouseup=null;
//				}
//			}

		//面向对象
			function Drag(obj){
				this.obj=obj.ele;
				this.minx=obj.rect.minx===undefined?null:obj.rect.minx;	
//				console.log(this.minx)
				this.miny=obj.rect.miny===undefined?null:obj.rect.miny;
				this.maxx=obj.rect.maxx===undefined?null:obj.rect.maxx;
				this.maxy=obj.rect.maxy===undefined?null:obj.rect.maxy;
				this.x1=obj.dir.x;
				this.y1=obj.dir.y;
				this.start()
			}
			Drag.prototype={
				start:function(){
					var that=this;
					this.obj.onmousedown=function(e){
						var ev=e||window.event;						
						if(ev.returnValue){
							ev.returnValue=false;
						}else{
							ev.preventDefault();
						}
						var left=that.obj.offsetLeft;
						var top=that.obj.offsetTop;
						var cx=ev.clientX;
						var cy=ev.clientY;
						that.prex=ev.clientX;
						that.prey=ev.clientY;
						that.x=cx-left;						
						that.y=cy-left;
						that.move();
						that.up();
						
					}
				},
				move:function(){
					var that=this;
					document.onmousemove=function(e){	
						var ev=e||window.event;
						if(ev.returnValue){
							ev.returnValue=false;
						}else{
							ev.preventDefault();
						}
						var cx=ev.clientX;
						var cy=ev.clientY;
//						console.log(that.x)
						var x=cx-that.x;
						var y=cy-that.y;
						that.lenx=cx-that.prex;
						that.leny=cx-that.prey;
						if(x<=that.minx){
//							alert(1)
//							console.log(x)
							x=that.minx;
						}
						if(y<=that.miny){
							y=that.miny;
						}
						if(x>=that.maxx-that.obj.offsetWidth&&that.maxx){
							x=that.maxx-that.obj.offsetWidth;
						}
						if(y>=that.maxy-that.obj.offsetHeight&&that.maxy){
							y=that.maxy-that.obj.offsetHeight;
						}
//						console.dir(that.x1)
//						console.log(that.x1==false)
//						console.log(that.x1===false?that.x1:true)
						//上面这两种写法完全不一样
						if(that.x1===false?that.x1:true){							
							that.obj.style.left=x+"px";							
						}
//						console.log(that.y1?true:false)						
						if(that.y1===false?that.y1:true){
							that.obj.style.top=y+"px";
						}
						that.prex=cx;
						that.prey=cy;
					}
				},
				up:function(){
					var that=this;
					document.onmouseup=function(e){
						document.onmousemove=null;
						document.onmouseup=null;
						that.animate();
					}
				},
				animate:function(){
					var xishu=0.7;
					var t=setInterval(()=>{
						this.lenx*=xishu;
						this.leny*=xishu;
						that.x=that.x+this.lenx;
						that.y=that.y+this.leny;
						this.obj.style.left=x+"px";							
						this.obj.style.top=y+"px";						
						if(Math.abs(this.lenx)<1&&Math.abs(this.lenx)<1){
							clearInterval(t);
						}
					},5000)
				}
			}
			var div=document.querySelector(".inner");
			new Drag({
				ele:div,
				rect:{
//					minx:0,maxx:200,miny:0,maxy:200
				},
				dir:{
					x:true,y:true
				}})
		})
	</script>	
	<body>
		<div class="outer">
			<div class="inner">dfsfsf</div>
		</div>
	</body>
</html>
